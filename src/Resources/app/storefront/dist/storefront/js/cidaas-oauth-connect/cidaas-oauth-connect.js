(()=>{"use strict";var e={857:e=>{var t=function(e){var t;return!!e&&"object"==typeof e&&"[object RegExp]"!==(t=Object.prototype.toString.call(e))&&"[object Date]"!==t&&e.$$typeof!==i},i="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function n(e,t){return!1!==t.clone&&t.isMergeableObject(e)?a(Array.isArray(e)?[]:{},e,t):e}function s(e,t,i){return e.concat(t).map(function(e){return n(e,i)})}function r(e){return Object.keys(e).concat(Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter(function(t){return Object.propertyIsEnumerable.call(e,t)}):[])}function o(e,t){try{return t in e}catch(e){return!1}}function a(e,i,l){(l=l||{}).arrayMerge=l.arrayMerge||s,l.isMergeableObject=l.isMergeableObject||t,l.cloneUnlessOtherwiseSpecified=n;var c,d,u=Array.isArray(i);return u!==Array.isArray(e)?n(i,l):u?l.arrayMerge(e,i,l):(d={},(c=l).isMergeableObject(e)&&r(e).forEach(function(t){d[t]=n(e[t],c)}),r(i).forEach(function(t){(!o(e,t)||Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))&&(o(e,t)&&c.isMergeableObject(i[t])?d[t]=(function(e,t){if(!t.customMerge)return a;var i=t.customMerge(e);return"function"==typeof i?i:a})(t,c)(e[t],i[t],c):d[t]=n(i[t],c))}),d)}a.all=function(e,t){if(!Array.isArray(e))throw Error("first argument should be an array");return e.reduce(function(e,i){return a(e,i,t)},{})},e.exports=a}},t={};function i(n){var s=t[n];if(void 0!==s)return s.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,i),r.exports}(()=>{i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t}})(),(()=>{i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}})(),(()=>{i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e=i(857),t=i.n(e);class n{static ucFirst(e){return e.charAt(0).toUpperCase()+e.slice(1)}static lcFirst(e){return e.charAt(0).toLowerCase()+e.slice(1)}static toDashCase(e){return e.replace(/([A-Z])/g,"-$1").replace(/^-/,"").toLowerCase()}static toLowerCamelCase(e,t){let i=n.toUpperCamelCase(e,t);return n.lcFirst(i)}static toUpperCamelCase(e,t){return t?e.split(t).map(e=>n.ucFirst(e.toLowerCase())).join(""):n.ucFirst(e.toLowerCase())}static parsePrimitive(e){try{return/^\d+(.|,)\d+$/.test(e)&&(e=e.replace(",",".")),JSON.parse(e)}catch(t){return e.toString()}}}class s{static isNode(e){return"object"==typeof e&&null!==e&&(e===document||e===window||e instanceof Node)}static hasAttribute(e,t){if(!s.isNode(e))throw Error("The element must be a valid HTML Node!");return"function"==typeof e.hasAttribute&&e.hasAttribute(t)}static getAttribute(e,t){let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(i&&!1===s.hasAttribute(e,t))throw Error('The required property "'.concat(t,'" does not exist!'));if("function"!=typeof e.getAttribute){if(i)throw Error("This node doesn't support the getAttribute function!");return}return e.getAttribute(t)}static getDataAttribute(e,t){let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=t.replace(/^data(|-)/,""),o=n.toLowerCamelCase(r,"-");if(!s.isNode(e)){if(i)throw Error("The passed node is not a valid HTML Node!");return}if(void 0===e.dataset){if(i)throw Error("This node doesn't support the dataset attribute!");return}let a=e.dataset[o];if(void 0===a){if(i)throw Error('The required data attribute "'.concat(t,'" does not exist on ').concat(e,"!"));return a}return n.parsePrimitive(a)}static querySelector(e,t){let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(i&&!s.isNode(e))throw Error("The parent node is not a valid HTML Node!");let n=e.querySelector(t)||!1;if(i&&!1===n)throw Error('The required element "'.concat(t,'" does not exist in parent node!'));return n}static querySelectorAll(e,t){let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(i&&!s.isNode(e))throw Error("The parent node is not a valid HTML Node!");let n=e.querySelectorAll(t);if(0===n.length&&(n=!1),i&&!1===n)throw Error('At least one item of "'.concat(t,'" must exist in parent node!'));return n}static getFocusableElements(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body;return e.querySelectorAll('\n            input:not([tabindex^="-"]):not([disabled]):not([type="hidden"]),\n            select:not([tabindex^="-"]):not([disabled]),\n            textarea:not([tabindex^="-"]):not([disabled]),\n            button:not([tabindex^="-"]):not([disabled]),\n            a[href]:not([tabindex^="-"]):not([disabled]),\n            [tabindex]:not([tabindex^="-"]):not([disabled])\n        ')}static getFirstFocusableElement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body;return this.getFocusableElements(e)[0]}static getLastFocusableElement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=this.getFocusableElements(e);return t[t.length-1]}}class r{publish(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=new CustomEvent(e,{detail:t,cancelable:i});return this.el.dispatchEvent(n),n}subscribe(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=this,s=e.split("."),r=i.scope?t.bind(i.scope):t;if(i.once&&!0===i.once){let t=r;r=function(i){n.unsubscribe(e),t(i)}}return this.el.addEventListener(s[0],r),this.listeners.push({splitEventName:s,opts:i,cb:r}),!0}unsubscribe(e){let t=e.split(".");return this.listeners=this.listeners.reduce((e,i)=>([...i.splitEventName].sort().toString()===t.sort().toString()?this.el.removeEventListener(i.splitEventName[0],i.cb):e.push(i),e),[]),!0}reset(){return this.listeners.forEach(e=>{this.el.removeEventListener(e.splitEventName[0],e.cb)}),this.listeners=[],!0}get el(){return this._el}set el(e){this._el=e}get listeners(){return this._listeners}set listeners(e){this._listeners=e}constructor(e=document){this._el=e,e.$emitter=this,this._listeners=[]}}class o{init(){throw Error('The "init" method for the plugin "'.concat(this._pluginName,'" is not defined.'))}update(){}_init(){this._initialized||(this.init(),this._initialized=!0)}_update(){this._initialized&&this.update()}_mergeOptions(e){let i=n.toDashCase(this._pluginName),r=s.getDataAttribute(this.el,"data-".concat(i,"-config"),!1),o=s.getAttribute(this.el,"data-".concat(i,"-options"),!1),a=[this.constructor.options,this.options,e];r&&a.push(window.PluginConfigManager.get(this._pluginName,r));try{o&&a.push(JSON.parse(o))}catch(e){throw console.error(this.el),Error('The data attribute "data-'.concat(i,'-options" could not be parsed to json: ').concat(e.message))}return t().all(a.filter(e=>e instanceof Object&&!(e instanceof Array)).map(e=>e||{}))}_registerInstance(){window.PluginManager.getPluginInstancesFromElement(this.el).set(this._pluginName,this),window.PluginManager.getPlugin(this._pluginName,!1).get("instances").push(this)}_getPluginName(e){return e||(e=this.constructor.name),e}constructor(e,t={},i=!1){if(!s.isNode(e))throw Error("There is no valid element given.");this.el=e,this.$emitter=new r(this.el),this._pluginName=this._getPluginName(i),this.options=this._mergeOptions(t),this._initialized=!1,this._registerInstance(),this._init()}}class a{get(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"application/json",n=this._createPreparedRequest("GET",e,i);return this._sendRequest(n,null,t)}post(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"application/json";n=this._getContentType(t,n);let s=this._createPreparedRequest("POST",e,n);return this._sendRequest(s,t,i)}delete(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"application/json";n=this._getContentType(t,n);let s=this._createPreparedRequest("DELETE",e,n);return this._sendRequest(s,t,i)}patch(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"application/json";n=this._getContentType(t,n);let s=this._createPreparedRequest("PATCH",e,n);return this._sendRequest(s,t,i)}abort(){if(this._request)return this._request.abort()}setErrorHandlingInternal(e){this._errorHandlingInternal=e}_registerOnLoaded(e,t){t&&(!0===this._errorHandlingInternal?(e.addEventListener("load",()=>{t(e.responseText,e)}),e.addEventListener("abort",()=>{console.warn("the request to ".concat(e.responseURL," was aborted"))}),e.addEventListener("error",()=>{console.warn("the request to ".concat(e.responseURL," failed with status ").concat(e.status))}),e.addEventListener("timeout",()=>{console.warn("the request to ".concat(e.responseURL," timed out"))})):e.addEventListener("loadend",()=>{t(e.responseText,e)}))}_sendRequest(e,t,i){return this._registerOnLoaded(e,i),e.send(t),e}_getContentType(e,t){return e instanceof FormData&&(t=!1),t}_createPreparedRequest(e,t,i){return this._request=new XMLHttpRequest,this._request.open(e,t),this._request.setRequestHeader("X-Requested-With","XMLHttpRequest"),i&&this._request.setRequestHeader("Content-type",i),this._request}constructor(){this._request=null,this._errorHandlingInternal=!1}}class l{static iterate(e,t){if(e instanceof Map||Array.isArray(e))return e.forEach(t);if(e instanceof FormData){for(var i of e.entries())t(i[1],i[0]);return}if(e instanceof NodeList)return e.forEach(t);if(e instanceof HTMLCollection)return Array.from(e).forEach(t);if(e instanceof Object)return Object.keys(e).forEach(i=>{t(e[i],i)});throw Error("The element type ".concat(typeof e," is not iterable!"))}}let c="loader",d={BEFORE:"before",INNER:"inner"};class u{create(){if(!this.exists()){if(this.position===d.INNER){this.parent.innerHTML=u.getTemplate();return}this.parent.insertAdjacentHTML(this._getPosition(),u.getTemplate())}}remove(){let e=this.parent.querySelectorAll(".".concat(c));l.iterate(e,e=>e.remove())}exists(){return this.parent.querySelectorAll(".".concat(c)).length>0}_getPosition(){return this.position===d.BEFORE?"afterbegin":"beforeend"}static getTemplate(){return'<div class="'.concat(c,'" role="status">\n                    <span class="').concat("visually-hidden",'">Loading...</span>\n                </div>')}static SELECTOR_CLASS(){return c}constructor(e,t=d.BEFORE){this.parent=e instanceof Element?e:document.body.querySelector(e),this.position=t}}class h extends u{create(){super.create(),this._isButtonElement()?this.parent.disabled=!0:this._isAnchorElement()&&this.parent.classList.add("disabled")}remove(){super.remove(),this._isButtonElement()?this.parent.disabled=!1:this._isAnchorElement()&&this.parent.classList.remove("disabled")}_isButtonElement(){return"button"===this.parent.tagName.toLowerCase()}_isAnchorElement(){return"a"===this.parent.tagName.toLowerCase()}constructor(e,t="before"){if(super(e,t),!this._isButtonElement()&&!this._isAnchorElement())throw Error("Parent element is not of type <button> or <a>")}}class p extends o{init(){this.client=new a,this.email=null,this.password=null,this.nextButton=s.querySelector(document,"#nextButton"),this.nextLoadingThingy=new h(this.nextButton),this.nextButton.addEventListener("click",e=>{null===this.email?(this.email=document.querySelector("#email").value,this.nextLoadingThingy.create(),this.client.post(this.options.cidaas+"/users-srv/user/checkexists/"+this.options.requestId,JSON.stringify({email:this.email,requestId:this.options.requestId}),e=>{e?JSON.parse(e).success?this.client.post("/cidaas/exists",JSON.stringify({email:this.email}),e=>{let t=JSON.parse(e);t.exists&&this.client.get("/cidaas/lastlogin/"+t.id,e=>{null!==JSON.parse(e).lastLogin?(document.querySelector("#emailContainer").style.display="none",document.querySelector("#passwordContainer").style.display="block",document.querySelector("#nextButton").textContent="Login",this.nextLoadingThingy.remove(),document.querySelector("#password").focus()):(document.querySelector("#emailContainer").style.display="none",document.querySelector("#onetimePassword").style.display="block",this.nextLoadingThingy.remove(),document.querySelector("#nextButton").style.display="none",document.querySelector("#toOtpLink").setAttribute("href",this.options.cidaas+"/identity/login/initiate?userIdHint="+encodeURI(this.email)+"&requestId="+this.options.requestId+"&type=email"))})}):(document.querySelector("#emailContainer").style.display="none",document.querySelector("#nextButton").style.display="none",this.nextLoadingThingy.remove(),document.querySelector("#complete").style.display="block"):window.location.href="/cidaas/register?userIdHint="+this.email+"&type=email"})):null===this.password&&(this.password=document.querySelector("#password").value,document.querySelector("#loginForm").dispatchEvent(new Event("submit")))})}handleFormResponse(e){}}p.options={};class m{init(e){this.client=new a,this.url=e,this.scope="openid offline_access email profile groups",this.cidaasUris={generateRequest:"/authz-srv/authrequest/authz/generate",login:"/login-srv/login",changePassword:"/users-srv/changepassword",logout:"/session/end_session",token:"/token-srv/token",emailAuth:"/identity/login/initiate"}}getRequest(e){return new Promise((t,i)=>{this.checkRequestData(e)||i("invalid object"),this.client.post(this.url+this.cidaasUris.generateRequest,JSON.stringify(e),e=>{t(JSON.parse(e))})})}getScope(){return this.scope}checkRequestData(e){let t=Object.keys(e),i=!0;return["client_id","redirect_uri","response_type","scope","state"].forEach(n=>{(0>t.indexOf(n)||""+e[n].length<1)&&(i=!1)}),i}getEmailAuthUri(e,t){return""+this.url+this.cidaasUris.emailAuth+"?userIdHint="+t+"&requestId="+e+"&type=email"}emailExists(e,t){return new Promise(i=>{this.client.post(this.url+"/users-srv/user/checkexists/"+t,JSON.stringify({email:e,requestId:t}),e=>{try{let t=JSON.parse(e);if(t)return i(t)}catch(e){}return i({exists:!1})})})}changePassword(e,t,i,n){return new Promise((s,r)=>{this.client.post(this.url+"/users-srv/changepassword",JSON.stringify({new_password:t,old_password:e,confirm_password:i,identityId:n}),e=>{try{let t=JSON.parse(e);s(t)}catch(e){r(e)}})})}constructor(e){this.init(e)}}let g="element-loader-backdrop";class y extends u{static create(e){e.classList.add("has-element-loader"),y.exists(e)||(y.appendLoader(e),setTimeout(()=>{let t=e.querySelector(".".concat(g));t&&t.classList.add("element-loader-backdrop-open")},1))}static remove(e){e.classList.remove("has-element-loader");let t=e.querySelector(".".concat(g));t&&t.remove()}static exists(e){return e.querySelectorAll(".".concat(g)).length>0}static getTemplate(){return'\n        <div class="'.concat(g,'">\n            <div class="loader" role="status">\n                <span class="').concat("visually-hidden",'">Loading...</span>\n            </div>\n        </div>\n        ')}static appendLoader(e){e.insertAdjacentHTML("beforeend",y.getTemplate())}}window.PluginManager.register("CidaasLogin",p,"[data-cidaas-login]"),window.PluginManager.register("CidaasInfo",class extends o{init(){this.infoShown=!1,this.emailAuth=!1,this.client=new a,this.cidaas=new m(this.options.cidaasUrl),this.clientId=this.options.clientId,this.nextButton=s.querySelector(document,"#weiterButton"),this.requestId="",this.redirectUrl=this.options.redirectUrl,this.nextLoadingThingy=new h(this.nextButton),document.getElementById("devButton").addEventListener("click",async()=>{let e={client_id:this.clientId,redirect_uri:this.redirectUrl,response_type:"code",scope:this.cidaas.getScope(),nonce:new Date().getTime()};this.cidaas.checkRequestData(e);let t=await this.cidaas.getRequest(e);this.requestId=t.data.requestId}),document.getElementById("infoForm").addEventListener("submit",e=>{e.preventDefault(),this.nextLoadingThingy.create(),this.email=document.getElementById("emailInput").value;let t=this.email.replaceAll("+","%2B");this.infoShown?this.emailAuth?(this.cidaas.getEmailAuthUri(this.requestId,this.email),window.location.href="/cidaas/login?redirect_login=email&email="+t+"&requestId="+this.requestId):(this.infoShown=!1,document.getElementById("emailContainer").style.display="block",document.getElementById("infoContainer").style.display="none",this.nextLoadingThingy.remove()):this.client.post("/cidaas/exists",JSON.stringify({email:this.email}),this.handleExistsData.bind(this))})}async handleExistsData(e){let t=JSON.parse(e),i={client_id:this.clientId,redirect_uri:this.redirectUrl,response_type:"code",scope:this.cidaas.getScope(),nonce:new Date().getTime(),state:this.options.state},n=await this.cidaas.getRequest(i);this.requestId=n.data.requestId;let s=this.email.replaceAll("+","%2B");t.exists?null===t.lastLogin?(this.nextLoadingThingy.remove(),document.getElementById("emailContainer").style.display="none",document.getElementById("buttonContainer").style.display="none",document.getElementById("infoContainer").style.display="block",document.getElementById("notYet").addEventListener("click",e=>{window.location.href=this.options.cidaasUrl+"/identity/password_forgot_init?userIdHint="+s+"&requestId="+this.requestId+"&type=email&redirect_to="+this.redirectUrl}),document.getElementById("already").addEventListener("click",e=>{window.location.href="/cidaas/login?redirect_login=email&email="+s+"&requestId="+this.requestId})):window.location.href="/cidaas/login?redirect_login=email&email="+s+"&requestId="+this.requestId:(await this.cidaas.emailExists(this.email,this.requestId)).success?window.location.href="/cidaas/login?redirect_login=email&email="+s+"&requestId="+this.requestId:window.location.href="/cidaas/register?userIdHint="+s+"&type=email"}},"[data-cidaas-info]"),window.PluginManager.register("CidaasEmailChange",class extends o{init(){this.client=new a,document.getElementById("emailForm").addEventListener("submit",this.handleSubmit.bind(this)),this.mailContainer=s.querySelector(document,"div#accountMailContainer")}sleep(e){return new Promise(t=>{setTimeout(t,e)})}handleSubmit(e){e.preventDefault();let t=document.getElementById("personalMail").value,i=document.getElementById("personalMailConfirmation").value;t===i?(document.getElementById("personalMailConfirmation").classList.remove("is-invalid"),document.getElementById("invalidFeedback").style.display="none",this.changeEmail(t,i)):(document.getElementById("invalidFeedback").style.display="block",document.getElementById("personalMailConfirmation").classList.add("is-invalid"))}async changeEmail(e,t){this.email=e,document.getElementById("emailForm").style.display="none",document.getElementById("emailVerifySpan").textContent=e,document.getElementById("verifyThing").style.display="block",document.getElementById("verifyButton").addEventListener("click",this.handleVerify.bind(this))}handleVerify(){y.create(this.mailContainer),this.client.post("/cidaas/change/email",JSON.stringify({email:this.email}),e=>{y.remove(this.mailContainer),document.getElementById("verifyThing").style.display="none",this.redirectProfilePath()})}redirectProfilePath(){let e="".concat(window.location.protocol,"//").concat(window.location.host),t=window.location.pathname.match(/^\/([a-z]{2})(\/|$)/i),i=t?t[1]:"",n=i?"".concat(e,"/").concat(i,"/account/profile"):"".concat(e,"/account/profile");window.location.href=n}},"[data-cidaas-email-change]"),window.PluginManager.register("CidaasPassword",class extends o{init(){document.getElementById("profilePasswordForm").addEventListener("submit",this.handleFormSubmit.bind(this)),this.newPasswordInput=document.getElementById("newPassword"),this.confirmPasswordInput=document.getElementById("passwordConfirmation"),this.oldPasswordInput=document.getElementById("password"),this.client=new a,this.client.get("/cidaas/url",e=>{try{let t=JSON.parse(e);this.cidaasUrl=t.url,this.cidaas=new m(t.url)}catch(t){console.log(t,e)}})}async handleFormSubmit(e){e.preventDefault(),this.checkInputFields()&&this.client.post("/cidaas/changepassword",JSON.stringify({newPassword:this.newPasswordInput.value,oldPassword:this.oldPasswordInput.value,confirmPassword:this.confirmPasswordInput.value}),e=>{try{JSON.parse(e).success?this.redirectToUrl("/account/logout"):this.redirectToUrl("/account/profile")}catch(e){console.log(e)}})}sendSuccessInfo(){this.client.post("/cidaas/changepassword",JSON.stringify({result:!0}),e=>{window.location.href="/account"})}redirectToUrl(e){let t="".concat(window.location.protocol,"//").concat(window.location.host),i=window.location.pathname.match(/^\/([a-z]{2})(\/|$)/i),n=i?i[1]:"",s=n?"".concat(t,"/").concat(n).concat(e):"".concat(t).concat(e);window.location.href=s}checkInputFields(){let e=this.newPasswordInput.value,t=this.oldPasswordInput.value,i=this.confirmPasswordInput.value;return!(e.length<8)&&!(i.length<8)&&!(t.length<1)&&e===i}},"[data-cidaas-password]")})()})();